<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><title>Jurjan Brust - Inspect SharePoint list columns</title><meta name=description content="Jurjan Brust Blog"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="all,follow"><meta name=googlebot content="index,follow,snippet,archive"><meta property='og:title' content='Inspect SharePoint list columns'><meta property='og:image' content='https://jurjanbrust.github.io/img/listItems/listItems_2019-09-02-15-20-59.png'><meta property='og:description' content='Jurjan Brust Blog'><meta property='og:url' content='https://jurjanbrust.github.io/posts/posts/sharepoint/powershell/listitems/'><link rel=stylesheet href=https://jurjanbrust.github.io/posts/css/bootstrap.min.css><link rel=stylesheet href="//fonts.googleapis.com/css?family=Roboto:400,300,700,400italic"><link rel=stylesheet href="//fonts.googleapis.com/css?family=Montserrat:100"><link rel=stylesheet href=https://jurjanbrust.github.io/posts/css/font-awesome.min.css><link rel=stylesheet href=https://jurjanbrust.github.io/posts/css/owl.carousel.css><link rel=stylesheet href=https://jurjanbrust.github.io/posts/css/owl.theme.css><link href=https://jurjanbrust.github.io/posts/css/style.green.css rel=stylesheet id=theme-stylesheet><!--[if lt IE 9]><script src=https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js></script><script src=https://oss.maxcdn.com/respond/1.4.2/respond.min.js></script><![endif]--><link href=https://jurjanbrust.github.io/posts/css/custom.css rel=stylesheet><link rel="shortcut icon" href=https://jurjanbrust.github.io/posts/img/favicon.png></head><body><div id=all><div class=container-fluid><div class="row row-offcanvas row-offcanvas-left"><div id=sidebar class="col-xs-6 col-sm-4 col-md-3 sidebar-offcanvas"><div class=sidebar-content><a href=/><img src=/img/jurjan.png class=avatar></a><h1 class=sidebar-heading><a href=https://jurjanbrust.github.io/posts/>Jurjan Brust</a></h1><p class=sidebar-p>SharePoint | M365 | Azure | IoT</p><ul class=sidebar-menu><li><a href=https://jurjanbrust.github.io/posts/posts/>HOME</a></li><li><a href=https://jurjanbrust.github.io/posts/categories/projects>PROJECTS</a></li><li><a href=https://jurjanbrust.github.io/posts/categories/azure>AZURE</a></li><li><a href=https://jurjanbrust.github.io/posts/categories/sharepoint>SHAREPOINT / M365</a></li><li><a href=https://jurjanbrust.github.io/posts/about/>ABOUT</a></li><li><a href=https://jurjanbrust.github.io/posts/contact/>CONTACT</a></li></ul><p class=social><a href=/index.xml data-animate-hover=pulse class=email><i class="fa fa-rss"></i>
</a><a href=https://www.linkedin.com/in/jurjanbrust/ data-animate-hover=pulse class=external><i class="fa fa-linkedin"></i>
</a><a href=https://twitter.com/jurjanbrust data-animate-hover=pulse class="external twitter"><i class="fa fa-twitter"></i>
</a><a href=https://www.instagram.com/jurjanbrust/ title class="external instagram"><i class="fa fa-instagram"></i>
</a><a href=https://github.com/jurjanbrust data-animate-hover=pulse class=external><i class="fa fa-github"></i></a></p><div class=copyright><p class=credit>&copy;2025 Jurjan Brust</p></div></div></div><div class="col-xs-12 col-sm-8 col-md-9 content-column white-background"><div class="small-navbar visible-xs"><button type=button data-toggle=offcanvas class="btn btn-ghost pull-left"> <i class="fa fa-align-left"></i>Menu</button><h1 class=small-navbar-heading><a href=https://jurjanbrust.github.io/posts/>Jurjan Brust</a></h1></div><div class=row><div class=col-lg-8><div class=content-column-content><h1>Inspect SharePoint list columns</h1><p>This is a PowerShell script (op-prem) I use a lot to inspect SharePoint list columns.</p><p>There are also great third party tools such as SPI-Insider and SharePoint Manager to do a deep-inspection of your SharePoint site.
But I find that this simple PowerShell is also a great method to quickly inspect a list without starting a desktop application or browser plugin.</p><h2 id=preview>Preview</h2><p><img src=/img/listItems/listItems_2019-09-02-13-56-51.png alt="shadow rotate"></p><h2 id=usage>Usage</h2><ul><li>First parameter is the URL of the site</li><li>Second is the name of the list > If no list is found, all lists on the site will be displayed</li><li>Third (optional) list item ID, if no ID is supplied all list items in the list will be displayed</li><li>Fourth (optional) filter on the list column names</li></ul><h2 id=code>Code</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-PowerShell data-lang=PowerShell><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span><span style=color:#75715e># Copyright (C) www.jurjanbrust.nl - All Rights Reserved (MIT License)</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span><span><span style=color:#66d9ef>param</span>(
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span><span>	[Parameter(<span style=color:#a6e22e>Mandatory</span>=$True,<span style=color:#a6e22e>Position</span>=<span style=color:#ae81ff>1</span>)] [<span style=color:#66d9ef>string</span>]$url,
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span><span>	[Parameter(<span style=color:#a6e22e>Mandatory</span>=$True,<span style=color:#a6e22e>Position</span>=<span style=color:#ae81ff>2</span>)] [<span style=color:#66d9ef>string</span>]$listTitle,
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span><span>	[Parameter(<span style=color:#a6e22e>Mandatory</span>=$False,<span style=color:#a6e22e>Position</span>=<span style=color:#ae81ff>3</span>)] [<span style=color:#66d9ef>string</span>]$listItemID,
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span><span>	[Parameter(<span style=color:#a6e22e>Mandatory</span>=$False,<span style=color:#a6e22e>Position</span>=<span style=color:#ae81ff>4</span>)] [<span style=color:#66d9ef>string</span>]$filter
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span><span>)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span><span>Write-Host <span style=color:#e6db74>&#34;usage: ListItems.ps1 [url] [listTitle] [listItemID] [filter]       (listItemID and filter is optional)&#34;</span> -ForegroundColor Yellow -BackgroundColor Green
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span><span><span style=color:#66d9ef>if</span> ($null <span style=color:#f92672>-eq</span> (Get-PSSnapin -Name Microsoft.SharePoint.PowerShell -ErrorAction SilentlyContinue))
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12</span><span>{
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13</span><span>    Add-PSSnapin Microsoft.SharePoint.PowerShell
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14</span><span>}
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16</span><span><span style=color:#66d9ef>try</span> {
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17</span><span>	$web = Get-SPWeb $url -ErrorAction SilentlyContinue
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">18</span><span>	$list = $web.Lists[$listTitle]
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">19</span><span>} <span style=color:#66d9ef>catch</span> {
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">20</span><span>	Write-Host <span style=color:#e6db74>&#34;</span>$url<span style=color:#e6db74> does not exist&#34;</span> -ForegroundColor Red
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">21</span><span>	<span style=color:#66d9ef>break</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">22</span><span>}
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">23</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">24</span><span><span style=color:#66d9ef>if</span>(<span style=color:#f92672>-not</span> $listItemID)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">25</span><span>{
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">26</span><span>	Write-Host <span style=color:#e6db74>&#34;ListItemID was not supplied, listing all listitems&#34;</span> -BackgroundColor DarkGreen -ForegroundColor Black
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">27</span><span>	<span style=color:#66d9ef>if</span>($null <span style=color:#f92672>-eq</span> $list)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">28</span><span>	{
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">29</span><span>		Write-Host <span style=color:#e6db74>&#34;No list found, showing all available lists&#34;</span> -ForegroundColor Red
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">30</span><span>		$web.Lists | ForEach-Object {
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">31</span><span>			Write-Host $_.Title
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">32</span><span>		}
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">33</span><span>	}
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">34</span><span>	$list.Items | Format-Table
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">35</span><span>}
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">36</span><span><span style=color:#66d9ef>else</span> 
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">37</span><span>{
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">38</span><span>	Write-Host <span style=color:#e6db74>&#34;Showing specific ListItem: &#34;</span> -BackgroundColor DarkGreen -ForegroundColor Black
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">39</span><span>	<span style=color:#66d9ef>try</span> {
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">40</span><span>		$listItem = $list.GetItemByID($listItemID)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">41</span><span>	} <span style=color:#66d9ef>catch</span> {
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">42</span><span>		Write-Host <span style=color:#e6db74>&#34;Listitem </span>$listItemID<span style=color:#e6db74> does not exists&#34;</span> -ForegroundColor Red
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">43</span><span>		<span style=color:#66d9ef>break</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">44</span><span>	}
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">45</span><span>	
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">46</span><span>	<span style=color:#66d9ef>if</span>(<span style=color:#f92672>-not</span> $filter)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">47</span><span>	{
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">48</span><span>		$listItem.Fields | ForEach-Object {
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">49</span><span>	 		Write-Host $_.Title <span style=color:#e6db74>&#34;[&#34;</span> $_.InternalName <span style=color:#e6db74>&#34;]</span><span style=color:#ae81ff>`t`t</span><span style=color:#e6db74>&#34;</span> -NoNewline -ForegroundColor Yellow -BackgroundColor DarkRed
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">50</span><span>	 		Write-Host $listItem[$_.InternalName] -ForegroundColor Yellow -BackgroundColor Red
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">51</span><span>		}
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">52</span><span>	}
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">53</span><span>	<span style=color:#66d9ef>else</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">54</span><span>	{
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">55</span><span>		$listItem.Fields | Where-Object {$_.InternalName <span style=color:#f92672>-match</span> $filter} | ForEach-Object {
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">56</span><span>	 		Write-Host $_.Title <span style=color:#e6db74>&#34;[&#34;</span> $_.InternalName <span style=color:#e6db74>&#34;]</span><span style=color:#ae81ff>`t`t</span><span style=color:#e6db74>&#34;</span> -NoNewline -ForegroundColor Yellow -BackgroundColor DarkRed
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">57</span><span>			Write-Host $listItem[$_.InternalName] -ForegroundColor Yellow -BackgroundColor Red
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">58</span><span>		}
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">59</span><span>	}
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">60</span><span>}</span></span></code></pre></div><p><a class=button href=/files/sharepoint/lists/listItems.ps1>open raw file</a></p></div></div></div></div></div></div></div><script src=https://jurjanbrust.github.io/posts/js/jquery.min.js></script><script src=https://jurjanbrust.github.io/posts/js/bootstrap.min.js></script><script src=https://jurjanbrust.github.io/posts/js/jquery.cookie.js></script><script src=https://jurjanbrust.github.io/posts/js/ekko-lightbox.js></script><script src=https://jurjanbrust.github.io/posts/js/jquery.scrollTo.min.js></script><script src=https://jurjanbrust.github.io/posts/js/masonry.pkgd.min.js></script><script src=https://jurjanbrust.github.io/posts/js/imagesloaded.pkgd.min.js></script><script src=https://jurjanbrust.github.io/posts/js/owl.carousel.min.js></script><script src=https://jurjanbrust.github.io/posts/js/front.js></script></body></html>